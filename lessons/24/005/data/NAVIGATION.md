# Path integral metadynamics

Path integrals simulatins are able to describe the quantum thermodynamics
of distinguishable particles at finite temperature, and are the most accurate
approach to describe the behavior of light nuclei (e.g. hydrogen) at 
room temperature and above. 

They can be combined with metadynamics to accelerate the sampling of rare
events, and compute a "quantum free energies" that reflect (in an approximate
way) the effect of zero-point energy and tunneling on reaction rates. 

## Free-energy of the Zundel cation

This lecture provide a hands-on interactive tutorial (that you can also 
download and run locally) that uses the [i-PI code](http://ipi-code.org)
to perform path-integral simulations for the Zundel cation, a protonated
water dimer. PLUMED is used to compute appropriate collective variables,
using an input as follows

{% raw %}
<div style="width: 100%; float:left">
<div style="width: 90%; float:left" id="value_details_NAVIGATION.md_working_1.dat"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><table><tr><td style="padding:1px"><a href="NAVIGATION.md_working_1.dat.plumed.stderr"><img src="https://img.shields.io/badge/v2.9-passing-green.svg" alt="tested onv2.9" /></a></td></tr><tr><td style="padding:1px"><a href="NAVIGATION.md_working_1.dat.plumed_master.stderr"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested onmaster" /></a></td></tr></table></div></div>
<pre style="width=97%;">
<span style="color:blue" class="comment"># default units are LENGTH=nm ENERGY=kJ/mol TIME=ps</span>
<b name="NAVIGATION.md_working_1.datdoo" onclick='showPath("NAVIGATION.md_working_1.dat","NAVIGATION.md_working_1.datdoo","NAVIGATION.md_working_1.datdoo","black")'>doo</b><span style="display:none;" id="NAVIGATION.md_working_1.datdoo">The DISTANCE action with label <b>doo</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">doo</td><td width="5%"><font color="black">scalar</font></td><td>the DISTANCE between this pair of atoms</td></tr></table></span>: <div class="tooltip" style="color:green">DISTANCE<div class="right">Calculate the distance between a pair of atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/_d_i_s_t_a_n_c_e.html" style="color:green">More details</a><i></i></div></div> <div class="tooltip">ATOMS<div class="right">the pair of atom that we are calculating the distance between<i></i></div></div>=1,2 
<span id="NAVIGATION.md_working_1.datco1_short"><b name="NAVIGATION.md_working_1.datco1" onclick='showPath("NAVIGATION.md_working_1.dat","NAVIGATION.md_working_1.datco1","NAVIGATION.md_working_1.datco1_shortcut","blue")'>co1</b><span style="display:none;" id="NAVIGATION.md_working_1.datco1_shortcut">The DISTANCES action with label <b>co1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">co1</td><td width="5%"><font color="blue">vector</font></td><td>the DISTANCES between the each pair of atoms that were specified</td></tr><tr><td width="5%">co1_lessthan</td><td width="5%"><font color="black">scalar</font></td><td>the number of colvars that have a value less than a threshold</td></tr></table></span>: <div class="tooltip" style="color:green">DISTANCES<div class="right">Calculate the distances between multiple piars of atoms This action is <a class="toggler" href='javascript:;' onclick='toggleDisplay("NAVIGATION.md_working_1.datco1");'>a shortcut</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/_d_i_s_t_a_n_c_e_s.html">More details</a><i></i></div></div> <div class="tooltip">GROUPA<div class="right">Calculate the distances between all the atoms in GROUPA and all the atoms in GROUPB<i></i></div></div>=1 <div class="tooltip">GROUPB<div class="right">Calculate the distances between all the atoms in GROUPA and all the atoms in GROUPB<i></i></div></div>=3-7 <div class="tooltip">LESS_THAN<div class="right">calculate the number of variables that are less than a certain target value<i></i></div></div>={RATIONAL R_0=0.14}
</span><span id="NAVIGATION.md_working_1.datco1_long" style="display:none;"><span style="color:blue" class="comment"># PLUMED interprets the command:
</span><span class="toggler" style="color:red" onclick='toggleDisplay("NAVIGATION.md_working_1.datco1")'># co1: DISTANCES GROUPA=1 GROUPB=3-7 LESS_THAN={RATIONAL R_0=0.14}</span>
<span style="color:blue" class="comment"># as follows (Click the red comment above to revert to the short version of the input):</span>
<b name="NAVIGATION.md_working_1.datco1_vatom1" onclick='showPath("NAVIGATION.md_working_1.dat","NAVIGATION.md_working_1.datco1_vatom1","NAVIGATION.md_working_1.datco1_vatom1","violet")'>co1_vatom1</b><span style="display:none;" id="NAVIGATION.md_working_1.datco1_vatom1">The CENTER_FAST action with label <b>co1_vatom1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">co1_vatom1</td><td width="5%"><font color="violet">atoms</font></td><td>virtual atom calculated by CENTER_FAST action</td></tr></table></span>: <div class="tooltip" style="color:green">CENTER<div class="right">Calculate the center for a group of atoms, with arbitrary weights. <a href="https://www.plumed.org/doc-master/user-doc/html/_c_e_n_t_e_r.html" style="color:green">More details</a><i></i></div></div> <div class="tooltip">ATOMS<div class="right">the group of atoms that you are calculating the Gyration Tensor for<i></i></div></div>=1,3 
<b name="NAVIGATION.md_working_1.datco1_vatom2" onclick='showPath("NAVIGATION.md_working_1.dat","NAVIGATION.md_working_1.datco1_vatom2","NAVIGATION.md_working_1.datco1_vatom2","violet")'>co1_vatom2</b><span style="display:none;" id="NAVIGATION.md_working_1.datco1_vatom2">The CENTER_FAST action with label <b>co1_vatom2</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">co1_vatom2</td><td width="5%"><font color="violet">atoms</font></td><td>virtual atom calculated by CENTER_FAST action</td></tr></table></span>: <div class="tooltip" style="color:green">CENTER<div class="right">Calculate the center for a group of atoms, with arbitrary weights. <a href="https://www.plumed.org/doc-master/user-doc/html/_c_e_n_t_e_r.html" style="color:green">More details</a><i></i></div></div> <div class="tooltip">ATOMS<div class="right">the group of atoms that you are calculating the Gyration Tensor for<i></i></div></div>=1,4 
<b name="NAVIGATION.md_working_1.datco1_vatom3" onclick='showPath("NAVIGATION.md_working_1.dat","NAVIGATION.md_working_1.datco1_vatom3","NAVIGATION.md_working_1.datco1_vatom3","violet")'>co1_vatom3</b><span style="display:none;" id="NAVIGATION.md_working_1.datco1_vatom3">The CENTER_FAST action with label <b>co1_vatom3</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">co1_vatom3</td><td width="5%"><font color="violet">atoms</font></td><td>virtual atom calculated by CENTER_FAST action</td></tr></table></span>: <div class="tooltip" style="color:green">CENTER<div class="right">Calculate the center for a group of atoms, with arbitrary weights. <a href="https://www.plumed.org/doc-master/user-doc/html/_c_e_n_t_e_r.html" style="color:green">More details</a><i></i></div></div> <div class="tooltip">ATOMS<div class="right">the group of atoms that you are calculating the Gyration Tensor for<i></i></div></div>=1,5 
<b name="NAVIGATION.md_working_1.datco1_vatom4" onclick='showPath("NAVIGATION.md_working_1.dat","NAVIGATION.md_working_1.datco1_vatom4","NAVIGATION.md_working_1.datco1_vatom4","violet")'>co1_vatom4</b><span style="display:none;" id="NAVIGATION.md_working_1.datco1_vatom4">The CENTER_FAST action with label <b>co1_vatom4</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">co1_vatom4</td><td width="5%"><font color="violet">atoms</font></td><td>virtual atom calculated by CENTER_FAST action</td></tr></table></span>: <div class="tooltip" style="color:green">CENTER<div class="right">Calculate the center for a group of atoms, with arbitrary weights. <a href="https://www.plumed.org/doc-master/user-doc/html/_c_e_n_t_e_r.html" style="color:green">More details</a><i></i></div></div> <div class="tooltip">ATOMS<div class="right">the group of atoms that you are calculating the Gyration Tensor for<i></i></div></div>=1,6 
<b name="NAVIGATION.md_working_1.datco1_vatom5" onclick='showPath("NAVIGATION.md_working_1.dat","NAVIGATION.md_working_1.datco1_vatom5","NAVIGATION.md_working_1.datco1_vatom5","violet")'>co1_vatom5</b><span style="display:none;" id="NAVIGATION.md_working_1.datco1_vatom5">The CENTER_FAST action with label <b>co1_vatom5</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">co1_vatom5</td><td width="5%"><font color="violet">atoms</font></td><td>virtual atom calculated by CENTER_FAST action</td></tr></table></span>: <div class="tooltip" style="color:green">CENTER<div class="right">Calculate the center for a group of atoms, with arbitrary weights. <a href="https://www.plumed.org/doc-master/user-doc/html/_c_e_n_t_e_r.html" style="color:green">More details</a><i></i></div></div> <div class="tooltip">ATOMS<div class="right">the group of atoms that you are calculating the Gyration Tensor for<i></i></div></div>=1,7 
<b name="NAVIGATION.md_working_1.datco1_grp" onclick='showPath("NAVIGATION.md_working_1.dat","NAVIGATION.md_working_1.datco1_grp","NAVIGATION.md_working_1.datco1_grp","violet")'>co1_grp</b><span style="display:none;" id="NAVIGATION.md_working_1.datco1_grp">The GROUP action with label <b>co1_grp</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">co1_grp</td><td width="5%"><font color="violet">atoms</font></td><td>indices of atoms specified in GROUP</td></tr></table></span>: <div class="tooltip" style="color:green">GROUP<div class="right">Define a group of atoms so that a particular list of atoms can be referenced with a single label in definitions of CVs or virtual atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/_g_r_o_u_p.html" style="color:green">More details</a><i></i></div></div> <div class="tooltip">ATOMS<div class="right">the numerical indexes for the set of atoms in the group<i></i></div></div>=<b name="NAVIGATION.md_working_1.datco1_vatom1">co1_vatom1</b>,<b name="NAVIGATION.md_working_1.datco1_vatom2">co1_vatom2</b>,<b name="NAVIGATION.md_working_1.datco1_vatom3">co1_vatom3</b>,<b name="NAVIGATION.md_working_1.datco1_vatom4">co1_vatom4</b>,<b name="NAVIGATION.md_working_1.datco1_vatom5">co1_vatom5</b> 
<b name="NAVIGATION.md_working_1.datco1" onclick='showPath("NAVIGATION.md_working_1.dat","NAVIGATION.md_working_1.datco1","NAVIGATION.md_working_1.datco1","blue")'>co1</b><span style="display:none;" id="NAVIGATION.md_working_1.datco1">The DISTANCE action with label <b>co1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">co1</td><td width="5%"><font color="blue">vector</font></td><td>the DISTANCE for each set of specified atoms</td></tr></table></span>: <div class="tooltip" style="color:green">DISTANCE<div class="right">Calculate the distance between a pair of atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/_d_i_s_t_a_n_c_e.html" style="color:green">More details</a><i></i></div></div> <div class="tooltip">ATOMS1<div class="right">the pair of atom that we are calculating the distance between<i></i></div></div>=1,3 <div class="tooltip">ATOMS2<div class="right">the pair of atom that we are calculating the distance between<i></i></div></div>=1,4 <div class="tooltip">ATOMS3<div class="right">the pair of atom that we are calculating the distance between<i></i></div></div>=1,5 <div class="tooltip">ATOMS4<div class="right">the pair of atom that we are calculating the distance between<i></i></div></div>=1,6 <div class="tooltip">ATOMS5<div class="right">the pair of atom that we are calculating the distance between<i></i></div></div>=1,7 
<b name="NAVIGATION.md_working_1.datco1_lt" onclick='showPath("NAVIGATION.md_working_1.dat","NAVIGATION.md_working_1.datco1_lt","NAVIGATION.md_working_1.datco1_lt","blue")'>co1_lt</b><span style="display:none;" id="NAVIGATION.md_working_1.datco1_lt">The LESS_THAN action with label <b>co1_lt</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">co1_lt</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of a function that is one if the input is less than a threshold to the input vectors</td></tr></table></span>: <div class="tooltip" style="color:green">LESS_THAN<div class="right">Use a switching function to determine how many of the input variables are less than a certain cutoff. <a href="https://www.plumed.org/doc-master/user-doc/html/_l_e_s_s__t_h_a_n.html" style="color:green">More details</a><i></i></div></div> <div class="tooltip">ARG<div class="right">the values input to this function<i></i></div></div>=<b name="NAVIGATION.md_working_1.datco1">co1</b> <div class="tooltip">SWITCH<div class="right">This keyword is used if you want to employ an alternative to the continuous swiching function defined above<i></i></div></div>={RATIONAL R_0=0.14}
<b name="NAVIGATION.md_working_1.datco1_lessthan" onclick='showPath("NAVIGATION.md_working_1.dat","NAVIGATION.md_working_1.datco1_lessthan","NAVIGATION.md_working_1.datco1_lessthan","black")'>co1_lessthan</b><span style="display:none;" id="NAVIGATION.md_working_1.datco1_lessthan">The SUM action with label <b>co1_lessthan</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">co1_lessthan</td><td width="5%"><font color="black">scalar</font></td><td>the sum of all the elements in the input vector</td></tr></table></span>: <div class="tooltip" style="color:green">SUM<div class="right">Calculate the sum of the arguments <a href="https://www.plumed.org/doc-master/user-doc/html/_s_u_m.html" style="color:green">More details</a><i></i></div></div> <div class="tooltip">ARG<div class="right">the values input to this function<i></i></div></div>=<b name="NAVIGATION.md_working_1.datco1_lt">co1_lt</b> <div class="tooltip">PERIODIC<div class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></div></div>=NO
<span style="color:blue"># --- End of included input --- </span></span><span id="NAVIGATION.md_working_1.datco2_short"><b name="NAVIGATION.md_working_1.datco2" onclick='showPath("NAVIGATION.md_working_1.dat","NAVIGATION.md_working_1.datco2","NAVIGATION.md_working_1.datco2_shortcut","blue")'>co2</b><span style="display:none;" id="NAVIGATION.md_working_1.datco2_shortcut">The DISTANCES action with label <b>co2</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">co2</td><td width="5%"><font color="blue">vector</font></td><td>the DISTANCES between the each pair of atoms that were specified</td></tr><tr><td width="5%">co2_lessthan</td><td width="5%"><font color="black">scalar</font></td><td>the number of colvars that have a value less than a threshold</td></tr></table></span>: <div class="tooltip" style="color:green">DISTANCES<div class="right">Calculate the distances between multiple piars of atoms This action is <a class="toggler" href='javascript:;' onclick='toggleDisplay("NAVIGATION.md_working_1.datco2");'>a shortcut</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/_d_i_s_t_a_n_c_e_s.html">More details</a><i></i></div></div> <div class="tooltip">GROUPA<div class="right">Calculate the distances between all the atoms in GROUPA and all the atoms in GROUPB<i></i></div></div>=2 <div class="tooltip">GROUPB<div class="right">Calculate the distances between all the atoms in GROUPA and all the atoms in GROUPB<i></i></div></div>=3-7 <div class="tooltip">LESS_THAN<div class="right">calculate the number of variables that are less than a certain target value<i></i></div></div>={RATIONAL R_0=0.14}
</span><span id="NAVIGATION.md_working_1.datco2_long" style="display:none;"><span style="color:blue" class="comment"># PLUMED interprets the command:
</span><span class="toggler" style="color:red" onclick='toggleDisplay("NAVIGATION.md_working_1.datco2")'># co2: DISTANCES GROUPA=2 GROUPB=3-7 LESS_THAN={RATIONAL R_0=0.14}</span>
<span style="color:blue" class="comment"># as follows (Click the red comment above to revert to the short version of the input):</span>
<b name="NAVIGATION.md_working_1.datco2_vatom1" onclick='showPath("NAVIGATION.md_working_1.dat","NAVIGATION.md_working_1.datco2_vatom1","NAVIGATION.md_working_1.datco2_vatom1","violet")'>co2_vatom1</b><span style="display:none;" id="NAVIGATION.md_working_1.datco2_vatom1">The CENTER_FAST action with label <b>co2_vatom1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">co2_vatom1</td><td width="5%"><font color="violet">atoms</font></td><td>virtual atom calculated by CENTER_FAST action</td></tr></table></span>: <div class="tooltip" style="color:green">CENTER<div class="right">Calculate the center for a group of atoms, with arbitrary weights. <a href="https://www.plumed.org/doc-master/user-doc/html/_c_e_n_t_e_r.html" style="color:green">More details</a><i></i></div></div> <div class="tooltip">ATOMS<div class="right">the group of atoms that you are calculating the Gyration Tensor for<i></i></div></div>=2,3 
<b name="NAVIGATION.md_working_1.datco2_vatom2" onclick='showPath("NAVIGATION.md_working_1.dat","NAVIGATION.md_working_1.datco2_vatom2","NAVIGATION.md_working_1.datco2_vatom2","violet")'>co2_vatom2</b><span style="display:none;" id="NAVIGATION.md_working_1.datco2_vatom2">The CENTER_FAST action with label <b>co2_vatom2</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">co2_vatom2</td><td width="5%"><font color="violet">atoms</font></td><td>virtual atom calculated by CENTER_FAST action</td></tr></table></span>: <div class="tooltip" style="color:green">CENTER<div class="right">Calculate the center for a group of atoms, with arbitrary weights. <a href="https://www.plumed.org/doc-master/user-doc/html/_c_e_n_t_e_r.html" style="color:green">More details</a><i></i></div></div> <div class="tooltip">ATOMS<div class="right">the group of atoms that you are calculating the Gyration Tensor for<i></i></div></div>=2,4 
<b name="NAVIGATION.md_working_1.datco2_vatom3" onclick='showPath("NAVIGATION.md_working_1.dat","NAVIGATION.md_working_1.datco2_vatom3","NAVIGATION.md_working_1.datco2_vatom3","violet")'>co2_vatom3</b><span style="display:none;" id="NAVIGATION.md_working_1.datco2_vatom3">The CENTER_FAST action with label <b>co2_vatom3</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">co2_vatom3</td><td width="5%"><font color="violet">atoms</font></td><td>virtual atom calculated by CENTER_FAST action</td></tr></table></span>: <div class="tooltip" style="color:green">CENTER<div class="right">Calculate the center for a group of atoms, with arbitrary weights. <a href="https://www.plumed.org/doc-master/user-doc/html/_c_e_n_t_e_r.html" style="color:green">More details</a><i></i></div></div> <div class="tooltip">ATOMS<div class="right">the group of atoms that you are calculating the Gyration Tensor for<i></i></div></div>=2,5 
<b name="NAVIGATION.md_working_1.datco2_vatom4" onclick='showPath("NAVIGATION.md_working_1.dat","NAVIGATION.md_working_1.datco2_vatom4","NAVIGATION.md_working_1.datco2_vatom4","violet")'>co2_vatom4</b><span style="display:none;" id="NAVIGATION.md_working_1.datco2_vatom4">The CENTER_FAST action with label <b>co2_vatom4</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">co2_vatom4</td><td width="5%"><font color="violet">atoms</font></td><td>virtual atom calculated by CENTER_FAST action</td></tr></table></span>: <div class="tooltip" style="color:green">CENTER<div class="right">Calculate the center for a group of atoms, with arbitrary weights. <a href="https://www.plumed.org/doc-master/user-doc/html/_c_e_n_t_e_r.html" style="color:green">More details</a><i></i></div></div> <div class="tooltip">ATOMS<div class="right">the group of atoms that you are calculating the Gyration Tensor for<i></i></div></div>=2,6 
<b name="NAVIGATION.md_working_1.datco2_vatom5" onclick='showPath("NAVIGATION.md_working_1.dat","NAVIGATION.md_working_1.datco2_vatom5","NAVIGATION.md_working_1.datco2_vatom5","violet")'>co2_vatom5</b><span style="display:none;" id="NAVIGATION.md_working_1.datco2_vatom5">The CENTER_FAST action with label <b>co2_vatom5</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">co2_vatom5</td><td width="5%"><font color="violet">atoms</font></td><td>virtual atom calculated by CENTER_FAST action</td></tr></table></span>: <div class="tooltip" style="color:green">CENTER<div class="right">Calculate the center for a group of atoms, with arbitrary weights. <a href="https://www.plumed.org/doc-master/user-doc/html/_c_e_n_t_e_r.html" style="color:green">More details</a><i></i></div></div> <div class="tooltip">ATOMS<div class="right">the group of atoms that you are calculating the Gyration Tensor for<i></i></div></div>=2,7 
<b name="NAVIGATION.md_working_1.datco2_grp" onclick='showPath("NAVIGATION.md_working_1.dat","NAVIGATION.md_working_1.datco2_grp","NAVIGATION.md_working_1.datco2_grp","violet")'>co2_grp</b><span style="display:none;" id="NAVIGATION.md_working_1.datco2_grp">The GROUP action with label <b>co2_grp</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">co2_grp</td><td width="5%"><font color="violet">atoms</font></td><td>indices of atoms specified in GROUP</td></tr></table></span>: <div class="tooltip" style="color:green">GROUP<div class="right">Define a group of atoms so that a particular list of atoms can be referenced with a single label in definitions of CVs or virtual atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/_g_r_o_u_p.html" style="color:green">More details</a><i></i></div></div> <div class="tooltip">ATOMS<div class="right">the numerical indexes for the set of atoms in the group<i></i></div></div>=<b name="NAVIGATION.md_working_1.datco2_vatom1">co2_vatom1</b>,<b name="NAVIGATION.md_working_1.datco2_vatom2">co2_vatom2</b>,<b name="NAVIGATION.md_working_1.datco2_vatom3">co2_vatom3</b>,<b name="NAVIGATION.md_working_1.datco2_vatom4">co2_vatom4</b>,<b name="NAVIGATION.md_working_1.datco2_vatom5">co2_vatom5</b> 
<b name="NAVIGATION.md_working_1.datco2" onclick='showPath("NAVIGATION.md_working_1.dat","NAVIGATION.md_working_1.datco2","NAVIGATION.md_working_1.datco2","blue")'>co2</b><span style="display:none;" id="NAVIGATION.md_working_1.datco2">The DISTANCE action with label <b>co2</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">co2</td><td width="5%"><font color="blue">vector</font></td><td>the DISTANCE for each set of specified atoms</td></tr></table></span>: <div class="tooltip" style="color:green">DISTANCE<div class="right">Calculate the distance between a pair of atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/_d_i_s_t_a_n_c_e.html" style="color:green">More details</a><i></i></div></div> <div class="tooltip">ATOMS1<div class="right">the pair of atom that we are calculating the distance between<i></i></div></div>=2,3 <div class="tooltip">ATOMS2<div class="right">the pair of atom that we are calculating the distance between<i></i></div></div>=2,4 <div class="tooltip">ATOMS3<div class="right">the pair of atom that we are calculating the distance between<i></i></div></div>=2,5 <div class="tooltip">ATOMS4<div class="right">the pair of atom that we are calculating the distance between<i></i></div></div>=2,6 <div class="tooltip">ATOMS5<div class="right">the pair of atom that we are calculating the distance between<i></i></div></div>=2,7 
<b name="NAVIGATION.md_working_1.datco2_lt" onclick='showPath("NAVIGATION.md_working_1.dat","NAVIGATION.md_working_1.datco2_lt","NAVIGATION.md_working_1.datco2_lt","blue")'>co2_lt</b><span style="display:none;" id="NAVIGATION.md_working_1.datco2_lt">The LESS_THAN action with label <b>co2_lt</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">co2_lt</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of a function that is one if the input is less than a threshold to the input vectors</td></tr></table></span>: <div class="tooltip" style="color:green">LESS_THAN<div class="right">Use a switching function to determine how many of the input variables are less than a certain cutoff. <a href="https://www.plumed.org/doc-master/user-doc/html/_l_e_s_s__t_h_a_n.html" style="color:green">More details</a><i></i></div></div> <div class="tooltip">ARG<div class="right">the values input to this function<i></i></div></div>=<b name="NAVIGATION.md_working_1.datco2">co2</b> <div class="tooltip">SWITCH<div class="right">This keyword is used if you want to employ an alternative to the continuous swiching function defined above<i></i></div></div>={RATIONAL R_0=0.14}
<b name="NAVIGATION.md_working_1.datco2_lessthan" onclick='showPath("NAVIGATION.md_working_1.dat","NAVIGATION.md_working_1.datco2_lessthan","NAVIGATION.md_working_1.datco2_lessthan","black")'>co2_lessthan</b><span style="display:none;" id="NAVIGATION.md_working_1.datco2_lessthan">The SUM action with label <b>co2_lessthan</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">co2_lessthan</td><td width="5%"><font color="black">scalar</font></td><td>the sum of all the elements in the input vector</td></tr></table></span>: <div class="tooltip" style="color:green">SUM<div class="right">Calculate the sum of the arguments <a href="https://www.plumed.org/doc-master/user-doc/html/_s_u_m.html" style="color:green">More details</a><i></i></div></div> <div class="tooltip">ARG<div class="right">the values input to this function<i></i></div></div>=<b name="NAVIGATION.md_working_1.datco2_lt">co2_lt</b> <div class="tooltip">PERIODIC<div class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></div></div>=NO
<span style="color:blue"># --- End of included input --- </span></span><b name="NAVIGATION.md_working_1.datdc" onclick='showPath("NAVIGATION.md_working_1.dat","NAVIGATION.md_working_1.datdc","NAVIGATION.md_working_1.datdc","black")'>dc</b><span style="display:none;" id="NAVIGATION.md_working_1.datdc">The COMBINE action with label <b>dc</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">dc</td><td width="5%"><font color="black">scalar</font></td><td>a linear compbination</td></tr></table></span>: <div class="tooltip" style="color:green">COMBINE<div class="right">Calculate a polynomial combination of a set of other variables. <a href="https://www.plumed.org/doc-master/user-doc/html/_c_o_m_b_i_n_e.html" style="color:green">More details</a><i></i></div></div> <div class="tooltip">ARG<div class="right">the values input to this function<i></i></div></div>=<b name="NAVIGATION.md_working_1.datco1">co1.lessthan</b>,<b name="NAVIGATION.md_working_1.datco2">co2.lessthan</b> <div class="tooltip">COEFFICIENTS<div class="right"> the coefficients of the arguments in your function<i></i></div></div>=1,-1 <div class="tooltip">PERIODIC<div class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></div></div>=NO
<b name="NAVIGATION.md_working_1.datmtd" onclick='showPath("NAVIGATION.md_working_1.dat","NAVIGATION.md_working_1.datmtd","NAVIGATION.md_working_1.datmtd","black")'>mtd</b><span style="display:none;" id="NAVIGATION.md_working_1.datmtd">The METAD action with label <b>mtd</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">mtd.bias</td><td width="5%"><font color="black">scalar</font></td><td>the instantaneous value of the bias potential</td></tr></table></span>:   <div class="tooltip" style="color:green">METAD<div class="right">Used to performed metadynamics on one or more collective variables. <a href="https://www.plumed.org/doc-master/user-doc/html/_m_e_t_a_d.html" style="color:green">More details</a><i></i></div></div> <div class="tooltip">ARG<div class="right">the labels of the scalars on which the bias will act<i></i></div></div>=<b name="NAVIGATION.md_working_1.datdoo">doo</b>,<b name="NAVIGATION.md_working_1.datdc">dc</b> <div class="tooltip">PACE<div class="right">the frequency for hill addition<i></i></div></div>=10 <div class="tooltip">SIGMA<div class="right">the widths of the Gaussian hills<i></i></div></div>=0.005,0.05 <div class="tooltip">HEIGHT<div class="right">the heights of the Gaussian hills<i></i></div></div>=4 <div class="tooltip">FILE<div class="right"> a file in which the list of added hills is stored<i></i></div></div>=HILLS-pimd <div class="tooltip">BIASFACTOR<div class="right">use well tempered metadynamics and use this bias factor<i></i></div></div>=10 <div class="tooltip">TEMP<div class="right">the system temperature - this is only needed if you are doing well-tempered metadynamics<i></i></div></div>=300
<b name="NAVIGATION.md_working_1.datuwall" onclick='showPath("NAVIGATION.md_working_1.dat","NAVIGATION.md_working_1.datuwall","NAVIGATION.md_working_1.datuwall","black")'>uwall</b><span style="display:none;" id="NAVIGATION.md_working_1.datuwall">The UPPER_WALLS action with label <b>uwall</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">uwall.bias</td><td width="5%"><font color="black">scalar</font></td><td>the instantaneous value of the bias potential</td></tr><tr><td width="5%">uwall.force2</td><td width="5%"><font color="black">scalar</font></td><td>the instantaneous value of the squared force due to this bias potential</td></tr></table></span>: <div class="tooltip" style="color:green">UPPER_WALLS<div class="right">Defines a wall for the value of one or more collective variables, <a href="https://www.plumed.org/doc-master/user-doc/html/_u_p_p_e_r__w_a_l_l_s.html" style="color:green">More details</a><i></i></div></div> <div class="tooltip">ARG<div class="right">the arguments on which the bias is acting<i></i></div></div>=<b name="NAVIGATION.md_working_1.datdoo">doo</b> <div class="tooltip">AT<div class="right">the positions of the wall<i></i></div></div>=0.4 <div class="tooltip">KAPPA<div class="right">the force constant for the wall<i></i></div></div>=250
<br/><div class="tooltip" style="color:green">PRINT<div class="right">Print quantities to a file. <a href="https://www.plumed.org/doc-master/user-doc/html/_p_r_i_n_t.html" style="color:green">More details</a><i></i></div></div> <div class="tooltip">ARG<div class="right">the labels of the values that you would like to print to the file<i></i></div></div>=<b name="NAVIGATION.md_working_1.datdoo">doo</b>,<b name="NAVIGATION.md_working_1.datco1">co1.*</b>,<b name="NAVIGATION.md_working_1.datco2">co2.*</b>,<b name="NAVIGATION.md_working_1.datdc">dc</b>,<b name="NAVIGATION.md_working_1.datmtd">mtd.*</b>,<b name="NAVIGATION.md_working_1.datuwall">uwall</b> <div class="tooltip">STRIDE<div class="right"> the frequency with which the quantities of interest should be output<i></i></div></div>=10 <div class="tooltip">FILE<div class="right">the name of the file on which to output these quantities<i></i></div></div>=COLVAR-pimd
<span style="display:none;" id="NAVIGATION.md_working_1.dat">The PRINT action with label <b></b> calculates something</span><div class="tooltip" style="color:green">FLUSH<div class="right">This command instructs plumed to flush all the open files with a user specified frequency. <a href="https://www.plumed.org/doc-master/user-doc/html/_f_l_u_s_h.html" style="color:green">More details</a><i></i></div></div> <div class="tooltip">STRIDE<div class="right">the frequency with which all the open files should be flushed<i></i></div></div>=1
</pre>
 {% endraw %} 

Depending on your previous experience, you may want to follow the 
lessons on metadynamics, and the external tutorial on path integral
simulations.


```mermaid
flowchart LR
A[Basic plumed syntax] ==> B[Metadynamics]
B ==> D[Path integral metadynamics]
C[Introduction to path integrals] ==> D
click A "../../../21/001/data/NAVIGATION.html" "Follow this lecture for an introduction to PLUMED and enhanced sampling"
click B "../../../21/004/data/NAVIGATION.html" "Follow this lecture if you have never heard of metadynamics before"
click C "https://lab-cosmo.github.io/atomistic-cookbook/latest/examples/path-integrals/path-integrals.html" "An interactive tutorial on path integral simulations and how to perform them using i-PI"
click D "https://lab-cosmo.github.io/atomistic-cookbook/latest/examples/pi-metad/pi-metad.html" "The main tutorial: combine i-PI and PLUMED to compute free energies including quantum nuclear effects"
```

